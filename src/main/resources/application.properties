# ==========================
# DATABASE CONFIG (Render)
# ==========================
spring.datasource.url=jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# HikariCP settings (production-ready)
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000

# ==========================
# SERVER CONFIG (Render)
# ==========================
server.port=${PORT:8080}
server.shutdown=graceful

# Disable Tomcat shutdown port to remove "Invalid shutdown command" warnings
server.tomcat.shutdown-port=-1

# Trust proxy headers (important when behind Render/NGINX)
server.forward-headers-strategy=framework

# ==========================
# OPTIONAL SSO PROPERTIES
# ==========================
sso.client-id=${SSO_CLIENT_ID:}
sso.client-secret=${SSO_CLIENT_SECRET:}
sso.idp.authorize=${SSO_IDP_AUTHORIZE:https://patidar.xecurify.com/moas/idp/jwtsso/379431}

# ==========================
# SAML SSO Configuration
# ==========================
spring.security.saml2.relyingparty.registration.sso-saml-demo.identityprovider.metadata-uri=${SAML_METADATA_URI:https://patidar.xecurify.com/moas/metadata/saml/379431/432750}
spring.security.saml2.relyingparty.registration.sso-saml-demo.assertion-consumer-service-location=${APP_URL:https://miniorange-javasso.onrender.com}/saml2/authenticate/sso-saml-demo
spring.security.saml2.relyingparty.registration.sso-saml-demo.entity-id=${APP_URL:https://miniorange-javasso.onrender.com}/saml2/service-provider-metadata/sso-saml-demo

# ==========================
# OIDC (MiniOrange)
# ==========================
spring.security.oauth2.client.registration.miniorange.client-id=${OIDC_CLIENT_ID:default-client-id}
spring.security.oauth2.client.registration.miniorange.client-secret=${OIDC_CLIENT_SECRET:default-secret}
spring.security.oauth2.client.registration.miniorange.scope=openid,profile,email
spring.security.oauth2.client.registration.miniorange.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.miniorange.redirect-uri=${APP_URL:https://miniorange-javasso.onrender.com}/login/oauth2/code/miniorange
spring.security.oauth2.client.registration.miniorange.client-name=MiniOrange OIDC

spring.security.oauth2.client.provider.miniorange.authorization-uri=${OIDC_AUTH_URI:https://patidar.xecurify.com/moas/idp/openidsso}
spring.security.oauth2.client.provider.miniorange.token-uri=${OIDC_TOKEN_URI:https://patidar.xecurify.com/moas/rest/oauth/token}
spring.security.oauth2.client.provider.miniorange.user-info-uri=${OIDC_USERINFO_URI:https://patidar.xecurify.com/moas/rest/oauth/getuserinfo}
spring.security.oauth2.client.provider.miniorange.jwk-set-uri=${OIDC_JWK_URI:https://patidar.xecurify.com/moas/rest/jwks}
spring.security.oauth2.client.provider.miniorange.user-name-attribute=email

# ==========================
# Optional Debug Endpoints
# ==========================
sso.miniorange.introspection-uri=${OIDC_INTROSPECT_URI:https://patidar.xecurify.com/moas/rest/oauth/introspect}
sso.miniorange.revoke-uri=${OIDC_REVOKE_URI:https://patidar.xecurify.com/moas/rest/oauth/revoke}
sso.miniorange.metadata-uri=${OIDC_METADATA_URI:https://patidar.xecurify.com/moas/discovery/v2.0/ACEFsCqqXJikVNUwzyl3tAAwDSbjOD5C/.well-known/openid-configuration}

# ==========================
# LOGGING
# ==========================
logging.level.root=INFO
logging.level.com.example.springssodemo=INFO
logging.level.org.springframework.web=INFO
# Enable Spring Security debug only if needed
# logging.level.org.springframework.security=DEBUG
